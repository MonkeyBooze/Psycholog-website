# CLAUDE.md

This file provides guidance to Claude Code and Gemini Agent when working with code in this repository.

## Project Overview
**Project Name:** Spektrum Umysłu (Psychology Practice)
**Domain:** Healthcare / Psychology / GDPR (RODO)
**Region:** Poland (pl-pl, Europe/Warsaw)
**Language:** Code in English, User-facing strings in Polish.

**Technology Stack:**
- **Backend:** Django 5.2+, Python 3.13+
- **Frontend:** Vanilla CSS (`app/static/css/style.css`), HTML5 Django Templates
- **Database:** PostgreSQL (Prod), SQLite (Dev)
- **Static Files:** WhiteNoise with Brotli compression (`CompressedManifestStaticFilesStorage`)
- **Server:** Gunicorn (via Procfile)
- **Config:** django-environ (`.env` file, gitignored)
- **Security:** django-csp (CSP headers), django-ratelimit, bleach (HTML sanitization)

## Coding Standards & Guidelines

### Python (Backend)
- **Style:** Follow PEP8 strictly.
- **Type Hinting:** Use `typing` module for ALL function arguments and return values.
- **Strings:** Use f-strings (`f"{var}"`) exclusively.
- **Imports:** Sort: Standard Lib -> Third Party (Django) -> Local Apps.
- **Paths:** Use `pathlib.Path` objects, never `os.path.join`.
- **Safety:** Always validate permissions (`UserPassesTestMixin`, `@login_required`) for views.

### Frontend (Vanilla CSS)
- **No Tailwind / No npm.** All styling lives in `app/static/css/style.css`.
- **Responsive:** Mobile-first approach — base styles are mobile, `@media` queries for desktop.
  - All grids collapse to single column on mobile.
  - CTAs become full-width on mobile.
- **Colors:** Use CSS custom properties defined in `style.css` (e.g. `var(--primary-color)`).
- **Layout:** Use CSS Grid and Flexbox. No floats.

#### Typography
- **Font Families:** Keep existing font families. Do not change fonts.
- **Sizes/Weights:** Adjust sizes and weights as specified per section/design.

#### Animations
- **Fade-in-on-scroll:** Add subtle fade-in effect to all major sections.
  - Staggered timing: ~200ms delay between elements.
  - Use CSS transitions only. No heavy JS animation libraries.

#### Icons
- **Icon Set:** Inline SVGs (no external icon library).
- **No Emoji:** Do not use emoji as icons in production code.

#### ZnanyLekarz Badge
- **Position:** Sticky floating element (bottom-right or top-right corner).
- **Content:** "⭐ 4.9/5 · ZnanyLekarz" (clickable, links to ZnanyLekarz profile).
- **Visibility:** Should appear on all pages.

## Security Notes
- **SECRET_KEY:** Loaded from `.env`. No default — app will crash if missing.
- **DEBUG:** Loaded from `.env`. Set `DEBUG=True` locally, `DEBUG=False` in production.
- **SSL/HSTS:** Auto-enabled when `DEBUG=False` via settings.py logic.
- **CSP:** Content-Security-Policy configured via `django-csp` in `settings.py`.
- **Rate Limiting:** `django-ratelimit` on `book()`, `data_subject_rights()`, `log_cookie_consent()`.
- **HTML Sanitization:** Custom `sanitize_html` template filter using `bleach` (replaces `|safe`).
- **CSRF:** All forms use `{% csrf_token %}`. Cookie consent AJAX sends `X-CSRFToken` header.

## Development Commands

### Setup & Run
```bash
# Activate virtual environment
.venv\Scripts\activate        # Windows
source .venv/bin/activate     # Linux/Mac

# Install dependencies
pip install -r requirements.txt

# Run migrations
python manage.py migrate

# Start Dev Server
python manage.py runserver

# Django system check
python manage.py check
```

### Key Directories
```
project/          # Django project settings, URLs, WSGI/ASGI
app/              # Main application (views, models, forms, templates)
app/static/       # CSS, images (source files)
app/templates/    # Django HTML templates
app/templatetags/ # Custom template filters (sanitize_html)
staticfiles/      # Generated by collectstatic (gitignored)
```